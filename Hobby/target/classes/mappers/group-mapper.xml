<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="group">
	<select id="count" resultType="int">
		select count(*) from groups
	</select>
	
	<select id="allList" parameterType="Map" resultType="gvo">
		select * from groups where g_status = '1' order by g_idx desc limit #{limit} offset #{offset} 
	</select>
	
	<select id="onelist" parameterType="String" resultType="gvo">
		select * from groups where g_idx = #{g_idx}
	</select>
	
	<insert id="insert" parameterType="gvo">
		insert into groups(g_title,g_intro, g_fname,g_maxPeople, g_date, g_location, g_desc,g_status, u_idx)
		values(#{g_title},#{g_intro},#{g_fname},#{g_maxPeople},#{g_date},#{g_location},#{g_desc},1,#{u_idx})
	</insert>
	
	<update id="delete" parameterType="gvo">
		update groups
		set g_status= '0' where g_idx = #{g_idx}
	</update>
	
	<update id="update" parameterType="gvo">
		update groups set g_title= #{g_title},g_intro= #{g_intro},g_fname= #{g_fname},g_maxPeople= #{g_maxPeople},
		g_date= #{g_date},g_location= #{g_location},g_desc= #{g_desc}, u_idx= #{u_idx} where g_idx = #{g_idx}
	</update>
	
	<select id="cmtList" parameterType="String" resultType="gcvo">
		select * from groupComments where g_idx = #{g_idx}
	</select>
	
	<select id="getUserCmtInfo" parameterType="String" resultType="uvo">
        SELECT * FROM USERS WHERE u_idx = #{u_idx}
    </select>
    
    <insert id="cmtInsert" parameterType="gcvo">
		insert into groupComments(gc_content, gc_date, u_idx, g_idx)
		values(#{gc_content}, sysdate(), #{u_idx}, #{g_idx})
	</insert>
    
</mapper>